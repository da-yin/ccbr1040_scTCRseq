
Single cell TCR-seq data analysis
=======================

Background:
-----------

TCR is a specific molecule on the surface of T cell, responsible for recognizing antigens presented by the major histocompatibility complex (MHC). In humans, most of TCRs consist of α and β chains. TCR β chain is generated by the random recombination of variable (V), diversity (D) and joining (J) gene segments, which generates the highly variable complementary determining region 3 (CDR3) that is critical for the specificity and affinity of antigen recognition. CDR3 polymorphisms account for TCR diversity and allow T cells to target any endogenous or exogenous antigen. T cells will be specifically activated and expanded through recognizing disease-associated antigens, which lead to a skewed distribution of TCR repertoire. Hence, the analysis of TCR repertoire can be used to reflect the immune responses for patients.

Aim:
-----------

Beta5t expressed by cTECs is critical for the development of CD8 T cells. We aim to understand how TCR repertoire is formed during thymocyte development in b5t-knockout and control mice.


The different stages of single cells from this project range from early progenitor (Double positive (DP: CD8+/CD4+) cells) which are non-selected, and then progress gradually to become fully selected, mature CD8+ T cells.  Mutation of the PSMB11 gene (aka BETA5T) which is part of the proteasome and is exclusively expressed in cTEC (cortical Thymic Epithelial cells), and is the subunit that catalyzes cleavage of peptides which are presented by the MHC molecules to cells in the immune system (double positive cells) and is important for development of CD8+ T cells.  Along with TCR signal, there’s an upregulation of CD69 (stage 2).  It’s thought that the mutation in the proteosomal protein may change the nature of cleavage of peptides that are presented and may either make TCR’s less selected or make fewer CD8+ cells.  What initial evidence indicate is that there may be similar numbers of TCR’s between WT and KO but that there are differences in TCR types (less selected?) across WT and KO animals. The question to address with his TCR-Seq analysis centers on the clonality of TCR sequences that emerge from different stages of development along with the differences in WT (heterozygous) vs KO (mutant) mice. 


Cell hashing:
----------- 

HTO001 – CD69low CCR7 low (I) Double positive in the cortex of the Thymus (most immature, not all have T cell receptors)
HTO002 – CD69hi CCR7 low (II) Double positive in the cortex of the Thymus (has received TCR stimulus)
HTO004 – CD69hi CCR7hi (IV) CD8 single positive in the medulla of the Thymus
HTO005 – CD69low CCR7hi (V) CD8 single positive in the medulla of the Thymus (ready to leave Thymus “mature”)

Stages:
-----------
 
HT01: DP (CD8+/CD4+ stage 1, unsignaled) -> HT02: DP (CD8+/CD4+ stage 2, recognition of peptide) -> HT04: Stage 3 -> HT05: Stage 4 (CD8+, fully selected, medullary)  peripheral lymphoid organs (spleen, lymph nodes)
 
Samples:
-----------
 
1MF1 – sample set one HET mouse
1MF2 – sample set one KO mouse
2MF1 – sample set two HET mouse (poor hashing, low RNA reads, high mitochondrial content), excluded
2MF2 – sample set two KO mouse (poor hashing, low RNA reads, high mitochondrial content), excluded
3MF1 – sample set three HET mouse
3MF2 – sample set three KO mouse

Batch-correction:
-----------

There seems to be clear batch effects between sample set one (1MF1, 1MF2) and sample set three (3MF1, 3MF2) based on sample name projected on TSNE map and unsupervised clustering. Since we are going to collect more samples so having a reliable way to detect and remove technical variation between different batches is important. I tested several commonly used tools for batch removal (FastMNN, Harmony, Seurat3 standard integration, Seurat3 SCTtransform integration) on the dataset and decided the Seurat3 standard integration workflow does a good job. One can see the unsupervised clustering heatmaps, the “withoutBatchCorrection” one cluster samples mostly based on batch while after batch correction, most of them cluster based on sample condition(ko or het).
 
All the heatmaps are created using batch corrected gene expression value (integrated assay) while the Dotplot, VlnPlot and FeaturePlot are created using uncorrected data(RNA assay) as recommended by Seurat, for visualization purpose. However batch information will be taken into account and be used as latent variables when differential expression analysis is set up.
